"use strict";function ClickPromise(t,e){this.callable=t,this.clickbusPayments=e,this.count=0,this.callbackSuccess=function(){},this.callbackFail=function(){}}function ClickBusPayments(){this.options={paymentFormId:"payment_form",creditcardFieldId:"credit_card",securityCodeFieldId:"security_code",expirationMonthFieldId:"expiration_month",expirationYearFieldId:"expiration_year",holderNameFieldId:"holder_name",docTypeFieldId:"doc_type",docNumberFieldId:"doc_number",amountFieldId:"amount"},this.attributeNames={creditcardFieldId:"cardNumber",securityCodeFieldId:"securityCode",expirationMonthFieldId:"cardExpirationMonth",expirationYearFieldId:"cardExpirationYear",holderNameFieldId:"cardholderName",docTypeFieldId:"docType",docNumberFieldId:"docNumber"},this.optionalValues={test:!1,amountFieldId:!1,publicKey:!1},this.handlers=[],this.personalizedOptions=arguments,this.loaded=!1,this.clickPromise=[],this.paymentMethodId=null,this.token={},this.test="undefined"!=typeof this.personalizedOptions[0].test&&this.personalizedOptions[0].test,this.updateForm()}function addEvent(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent("on"+e,function(){i.call(t)})}function loadScript(t,e){var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.src=t,o.onreadystatechange=e,o.onload=e,i.appendChild(o)}function merge(t,e){if(!(arguments[0]&&arguments[0]instanceof Object))return t;for(var i in e)t[i]=e[i];return t}function MercadoPago(t){this.name="mercadopago",this.publicKey=t,this.javascript_url="https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js?nocache="+10*Math.random()}function MundiPagg(t){this.name="mundipagg",this.publicKey=t}ClickPromise.prototype.success=function(t){return this.callbackSuccess=t,this},ClickPromise.prototype.fail=function(t){return this.callbackFail=t,this},ClickPromise.prototype.call=function(){this.callable()},ClickPromise.prototype.finish=function(t,e){try{if(201==t||200==t){"master"===this.clickbusPayments.paymentMethodId&&(this.clickbusPayments.paymentMethodId="mastercard");var i={name:e.name,token:e.id,payment_method:this.clickbusPayments.paymentMethodId};this.count++,this.clickbusPayments.token[e.name]=i,this.count==this.clickbusPayments.handlers.length&&this.callbackSuccess(this.clickbusPayments.token)}else{var o=[];for(var n in e.cause){var s={code:e.cause[n].code,description:e.cause[n].description};o.push(s)}this.callbackFail(o)}}catch(t){this.callbackFail([t])}},ClickBusPayments.prototype.init=function(){this.start()},ClickBusPayments.prototype.setPaymentFormId=function(t){return this.options.paymentFormId=t,this.personalizedOptions[0].paymentFormId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setCreditcardFieldId=function(t){return this.options.creditcardFieldId=t,this.personalizedOptions[0].creditcardFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setSecurityCodeFieldId=function(t){return this.options.securityCodeFieldId=t,this.personalizedOptions[0].securityCodeFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setExpirationMonthFieldId=function(t){return this.options.expirationMonthFieldId=t,this.personalizedOptions[0].expirationMonthFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setExpirationYearFieldId=function(t){return this.options.expirationYearFieldId=t,this.personalizedOptions[0].expirationYearFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setHolderNameFieldId=function(t){return this.options.holderNameFieldId=t,this.personalizedOptions[0].holderNameFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setDocTypeFieldId=function(t){return this.options.docTypeFieldId=t,this.personalizedOptions[0].docTypeFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setDocNumberFieldId=function(t){return this.options.docNumberFieldId=t,this.personalizedOptions[0].docNumberFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.setAmountFieldId=function(t){return this.options.amountFieldId=t,this.personalizedOptions[0].amountFieldId=t,this.updateForm(),this.start(),this},ClickBusPayments.prototype.subscribe=function(t){this.handlers.push(t)},ClickBusPayments.prototype.start=function(){this.handlers.forEach(function(t){t.start()}),this.loaded=!0},ClickBusPayments.prototype.updateForm=function(){this.options=merge(this.options,this.personalizedOptions[0]);for(var t in this.options)if(!this.optionalValues.hasOwnProperty(t)){var e=document.getElementById(this.options[t]);if(!e){var i=this.options[t]+" is required";throw new Error(i)}this.attributeNames[t]&&e.setAttribute("data-checkout",this.attributeNames[t])}},ClickBusPayments.prototype.generateToken=function(){for(var t=document.getElementById(this.options.paymentFormId),e=t.getElementsByTagName("input"),i=0;i<e.length;i++)if(e[i].id==this.options.docNumberFieldId){var o=e[i].value;e[i].value=o.replace(/[^0-9]+/g,"")}return null===this.paymentMethodId&&this.guessingPaymentMethod(null,this),this.clickPromise=new ClickPromise(function(){this.clickbusPayments.handlers.forEach(function(e){e.createToken(t,this)},this)},this),this.clickPromise},ClickBusPayments.prototype.getBin=function(){var t=document.querySelector('input[data-checkout="cardNumber"]');if(!t)throw new Error("creditcardFieldId is required");return t.value.replace(/[ .-]/g,"").slice(0,6)},ClickBusPayments.prototype.setPaymentMethodInfo=function(t,e,i){200==t&&(i.paymentMethodId=e[0].id)},ClickBusPayments.prototype.guessingPaymentMethod=function(t,e){var i=this.getBin();null!=t&&"keyup"==t.type?i.length>=6&&Mercadopago.getPaymentMethod({bin:i},function(t,i){e.setPaymentMethodInfo(t,i,e)}.bind(e)):setTimeout(function(){i.length>=6&&Mercadopago.getPaymentMethod({bin:i},function(t,i){e.setPaymentMethodInfo(t,i,e)}.bind(e))},100)},ClickBusPayments.prototype.getAmount=function(){var t=document.getElementById(this.options.amountFieldId);if(!t)throw new Error("amountFieldId is required to get installments");return t.value},MercadoPago.prototype.start=function(){loadScript(this.javascript_url,function(){Mercadopago.setPublishableKey(this.publicKey)}.bind(this))},MercadoPago.prototype.createToken=function(t,e){Mercadopago.createToken(t,function(t,i){i.name=this.name,e.finish(t,i)}.bind(this))},MercadoPago.prototype.clearSession=function(){Mercadopago.clearSession()},MundiPagg.prototype.start=function(){},MundiPagg.prototype.createToken=function(t,e){return e.finish(201,{id:123,name:this.name})},MundiPagg.prototype.clearSession=function(){};